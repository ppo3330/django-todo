{% extends 'base.html' %}

{% block content %}
<h2>To-Do List</h2>

<div class="filters" style="margin-bottom: 15px;">
    <a href="?filter=all" 
       class="{% if filter == 'all' %}active-filter{% endif %}">전체</a> |
    <a href="?filter=active"
       class="{% if filter == 'active' %}active-filter{% endif %}">미완료</a> |
    <a href="?filter=completed"
       class="{% if filter == 'completed' %}active-filter{% endif %}">완료</a>
</div>

<ul>
    {% for task in tasks %}
        <li>
            <div>
                <form action="{% url 'task_toggle' task.pk %}" method="POST" style="display:inline;">
                    {% csrf_token %}
                    <input type="checkbox" onchange="this.form.submit()" {% if task.is_completed %}checked{% endif %}>
                </form>
                
                {% if task.is_completed %}
                    <span style="text-decoration: line-through; color: gray;">
                        {{ task.title }}
                    </span>
                {% else %}  
                    {{ task.title }}
                {% endif %}
            </div>

            <div>
                <a href="{% url 'task_edit' task.pk %}" class="btn btn-secondary">수정</a>
                <form action="{% url 'task_delete' task.pk %}"
                    method="POST"
                    onsubmit="return confirm('정말 삭제할까요?');"
                    style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">삭제</button>
                </form>
            </div>
        </li>
    {% empty %}
        <li>아직 할 일이 없습니다.</li>
    {% endfor %}
</ul>

<hr>

<h3>새 할 일 추가</h3>
<form method="POST">
    {% csrf_token %}
    <input type="text" name="title" placeholder="할 일 입력">
    <button type="submit" class="btn btn-primary">추가</button>
</form>
{% endblock %}